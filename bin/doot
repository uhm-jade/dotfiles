#!/usr/bin/env bash
DOTFILES_DIR="$HOME/.dotfiles"

wrapped_cmd() {
	/usr/bin/git --git-dir="$DOTFILES_DIR" --work-tree="$HOME" "$@"
}

doot() {

	case "$1" in
	status)
		wrapped_cmd status
		;;

	pull)
		wrapped_cmd stash push -m "Auto-stash before pull" || true
		wrapped_cmd pull --rebase
		wrapped_cmd stash pop || true
		;;
	checkout)
		wrapped_cmd checkout
		;;
	*)
		# echo "Usage: doot {status|pull|checkout|<git-args>}"

		# echo "All other arguments are passed directly to git"
		wrapped_cmd "$@"
		;;

	esac
}

# Call the dispatcher with all script arguments
doot "$@"
